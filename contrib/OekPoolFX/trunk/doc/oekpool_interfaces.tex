\documentclass[	
				a4paper, 
				twoside,
				11pt,
				DIV11,
				BCOR12mm,
				bibtotoc, 
				halfparskip, 
				headsepline, 
				pointlessnumbers]{scrartcl}

\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage[T1]{fontenc}
\usepackage[margin=2cm, includehead]{geometry}
\usepackage{bibgerm}
%\usepackage[numbers]{natbib}
\usepackage[dvips]{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{pstricks}
\usepackage{pst-math}
\usepackage{pstricks-add}
\usepackage{pst-plot}
\usepackage{pst-tree}
\usepackage{rotating}
\usepackage{fancybox}
\usepackage{fancyhdr}
\usepackage{colortbl}
\usepackage{listings}
\usepackage{url}
\usepackage{tikz}
\usepackage{graphics}
%\usepackage{graphicx}
% Define user colors using the RGB model
\definecolor{dunkelgrau}{rgb}{0.8,0.8,0.8}
\definecolor{hellgrau}{rgb}{0.95,0.95,0.95}
\definecolor{rot}{rgb}{1,0,0}
\definecolor{hellrot}{rgb}{1,0.7,0.7}
\definecolor{hellgruen}{rgb}{0.7,1,0.7}
\definecolor{hellgelb}{rgb}{1,1,0.5}

%============================================================================
\title{Schnittstellen für die OekPool-Anwendung}
\author{Julian Bader und Bastian Wißler}
\date{\today}
%============================================================================


\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\leftmark}
\fancyhead[R]{\rightmark}
\renewcommand{\headrulewidth}{0.2pt}
\fancyfoot[C]{\thepage}

\makeindex

%==============================================================================================================

\begin{document}

\maketitle
\indent
\begin{abstract}
\section*{Abstract}
In diesem Dokument werden alle externen Schnittstellen von und zur OekPool-Anwendung definiert.
Hierbei werden sowohl die Serverapplikation als auch das Webinterface betrachtet.
Als Dienst zur Speicherung anwendungsrelevanter Daten kommt LDAP zum Einsatz.
Zur Konfiguration der Clients wird TFTP und PXELinux verwendet.
Die Clients an sich werden per SSH gesteuert.
\end{abstract}
\newpage

\section{LDAP}
Im LDAP-Verzeichnis müssen drei Arten von Informationen enthalten sein.
Für Verwaltungs- und Identifikationszwecke benötigt die Anwendung clientbezogene Eigenschaften.
Um eine Zeitsteuerung zu ermöglichen werden für jeden Client Informationen bzgl. assoziierter PXE-Konfigurationen verwendet.
Damit die Wake-on-LAN auch in anderen IP-Netzen möglich ist, sind Informationen über die vom DHCP-Server verwalteten Netzwerke eforderlich.

\subsection{Clientbezogene Eigenschaften}
\subsection{Zeit- und PXE-Konfiguration}
\subsection{DHCP-Informationen}

\section{TFTP}
Auf dem TFTP-Server befinden sich, der Client-Konfiguration entsprechend, zwei Ausprägungen von PXE-Menüs.
Für alle Clients, die nicht über die Anwendung verwaltet werden bzw. nicht immer Zeitslots zugewiesen bekommen, muss ein \textit{Default}-Menü vorhanden sein.
Sämtliche Menüs, die im LDAP definiert sind müssen einmal auf dem TFTP-Server abgelegt werden, damit sie bei Bedarf (überlagernde Steuerung) verlinkt werden können.

\subsection{Default-Menü}
Damit die Clients, die (momentan) nicht über die Anwendung verwaltet werden, das \textit{Default}-Menü booten können, muss es unter der Datei \verb+default+ im Verzeichnis \verb+pxelinux.cfg+ im TFTP-Wurzelverzeichnis abgelegt werden.
Alle Clients die nicht anderweitig verlinkt sind laden automatisch diese Datei.
\subsection{Spezifische PXE-Menüs}
Um die spezifischen zeitgesteuerten Menüs zu erstellen und zu verlinken gibt es generell zwei Möglichkeiten.
Zum einen ist es möglich die Arbeit komplett durch das \textit{PXEGenerate}-Skript zu erledigen.
Andererseits kann man auch \textit{PXEGenerate} nur die Menüs erstellen lassen und die Anwendung verlinkt die entsprechenden Menüs, sobald sie benötigt werden.

Übernimmt \textit{PXEGenerate} die komplette Arbeit, werden die PXE-Menüs aus den Daten im LDAP erzeugt.
Bei Bedarf werden die erstellten Menüs im Verzeichnis \verb+pxelinux.cfg+ in der Form \verb+01-MAC+ (z.B. 01-00-01-a5-f8-68-1f) verlinkt, damit die Clients sie entsprechend der Zeitsteuerung laden.
Der Vorteil dieser Methode ist, dass es nur eine Komponente gibt, die auf den TFTP-Server zugreift. Die OekPool-Anwendung benötigt dann keinen Zugriff und kann auf einer dedizierten Maschine laufen.
Ein Nachteil dieser Methode ist, dass es bei schlechter Synchronisation der Systemuhren von TFTP- und OekPool-Server dazu kommen kann, dass Clients ein Menü vom TFTP-Server laden, bevor \textit{PXEGenerate} die Verlinkung aktualisiert hat.
Ein weiterer Nachtei ist, dass es nicht möglich ist PXE-Menüs dynamisch außerhalb der Zeitsteuerung, z.B. für administrative Zwecke, zu laden.

Soll die OekPool-Anwendung die Verlinkung übernehmen, so ist \textit{PXEGenerate} nur für die Erstellung der Menüs zuständig.
Die Verlinkung geschieht zeitnah direkt aus OekPool. Hierbei erwartet die Anwendung ein Unterverzeichnis \verb+configs+ unterhalb von \verb+pxelinux.cfg+.
Unterhalb des \verb+config+-Verzeichnisses sollte für jeden Client im LDAP ein Verzeichnis mit der entsprechenden MAC-Adresse als Name (in der Form 00-01-5e-34-ad-e3) angelegt werden.
In diesen Verzeichnissen sollte dann für jedes Menü eines Clients eine Datei angelegt werden. Der Name dieser Datei muss mit dem \textit{CommonName} (cn) des \textit{ActivePXEConfig}-Objektes korrespondieren, welches dem Menü entspricht.
Der Vorteil dieser Methode ist zum einen, dass es keine Synchronisationsprobleme gibt, da OekPool vor dem Rechnerstart das PXE-Menü selbst verlinkt.
Des weiteren ist es dadurch auch möglich die Zeitsteuerung dynamisch durch ein spezielles Menü, z.B. für administrative Zwecke, zu überlagern.
Der Nachteil dieses Ansatzes ist, dass die OekPool Anwenung Zugriff auf den TFTP-Server (direkt oder per NFS) benötigt um die Verlinkung zu übernehmen.
\section{SSH}

\end{document}
